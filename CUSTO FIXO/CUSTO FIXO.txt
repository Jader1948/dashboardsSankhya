USE [SANKHYA_PRODUCAO]
GO
/****** Object:  UserDefinedFunction [SANKHYA].[DashCustoFixo]    Script Date: 13/11/2023 22:30:05 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER FUNCTION [SANKHYA].[DashCustoFixo](
	@P_ANO INT, @P_DIVISAO CHAR(10))
RETURNS @PRINCIPAL
TABLE(
	CODCC INT null, DESCRCC CHAR(50), NIVEL CHAR(1), JAN FLOAT,FEV FLOAT,
		MAR FLOAT,ABR FLOAT,MAI FLOAT,JUN FLOAT,JUL FLOAT,AGO FLOAT,
		SETE FLOAT,OUTU FLOAT,NOV FLOAT,DEZ FLOAT,TOT FLOAT)
AS

BEGIN

DELETE FROM @PRINCIPAL

DECLARE @CODCENCUS AS INT
DECLARE @DESCRCENCUS AS CHAR(50)
DECLARE @CODCENCUS1 AS INT
DECLARE @DESCRCENCUS1 AS CHAR(50)
DECLARE @ANALITICO1 AS CHAR(1)
DECLARE @CODCENCUS2 AS INT
DECLARE @DESCRCENCUS2 AS CHAR(50)
DECLARE @ANALITICO2 AS CHAR(1)

DECLARE @VLRTOTF1_1  AS FLOAT
DECLARE @VLRTOTF1_2  AS FLOAT
DECLARE @VLRTOTF1_3  AS FLOAT
DECLARE @VLRTOTF1_4  AS FLOAT
DECLARE @VLRTOTF1_5  AS FLOAT
DECLARE @VLRTOTF1_6  AS FLOAT
DECLARE @VLRTOTF1_7  AS FLOAT
DECLARE @VLRTOTF1_8  AS FLOAT
DECLARE @VLRTOTF1_9  AS FLOAT
DECLARE @VLRTOTF1_10 AS FLOAT
DECLARE @VLRTOTF1_11 AS FLOAT
DECLARE @VLRTOTF1_12 AS FLOAT
DECLARE @VLRTOTGERALF1 AS FLOAT

DECLARE @VLRTOTGERF1_1  AS FLOAT
DECLARE @VLRTOTGERF1_2  AS FLOAT
DECLARE @VLRTOTGERF1_3  AS FLOAT
DECLARE @VLRTOTGERF1_4  AS FLOAT
DECLARE @VLRTOTGERF1_5  AS FLOAT
DECLARE @VLRTOTGERF1_6  AS FLOAT
DECLARE @VLRTOTGERF1_7  AS FLOAT
DECLARE @VLRTOTGERF1_8  AS FLOAT
DECLARE @VLRTOTGERF1_9  AS FLOAT
DECLARE @VLRTOTGERF1_10 AS FLOAT
DECLARE @VLRTOTGERF1_11 AS FLOAT
DECLARE @VLRTOTGERF1_12 AS FLOAT
DECLARE @VLRTOTGERGERALF1 AS FLOAT

DECLARE @VLRTOTV1_1  AS FLOAT
DECLARE @VLRTOTV1_2  AS FLOAT
DECLARE @VLRTOTV1_3  AS FLOAT
DECLARE @VLRTOTV1_4  AS FLOAT
DECLARE @VLRTOTV1_5  AS FLOAT
DECLARE @VLRTOTV1_6  AS FLOAT
DECLARE @VLRTOTV1_7  AS FLOAT
DECLARE @VLRTOTV1_8  AS FLOAT
DECLARE @VLRTOTV1_9  AS FLOAT
DECLARE @VLRTOTV1_10 AS FLOAT
DECLARE @VLRTOTV1_11 AS FLOAT
DECLARE @VLRTOTV1_12 AS FLOAT
DECLARE @VLRTOTGERALV1 AS FLOAT


DECLARE @VLRTOTGERV1_1  AS FLOAT
DECLARE @VLRTOTGERV1_2  AS FLOAT
DECLARE @VLRTOTGERV1_3  AS FLOAT
DECLARE @VLRTOTGERV1_4  AS FLOAT
DECLARE @VLRTOTGERV1_5  AS FLOAT
DECLARE @VLRTOTGERV1_6  AS FLOAT
DECLARE @VLRTOTGERV1_7  AS FLOAT
DECLARE @VLRTOTGERV1_8  AS FLOAT
DECLARE @VLRTOTGERV1_9  AS FLOAT
DECLARE @VLRTOTGERV1_10 AS FLOAT
DECLARE @VLRTOTGERV1_11 AS FLOAT
DECLARE @VLRTOTGERV1_12 AS FLOAT
DECLARE @VLRTOTGERGERALV1 AS FLOAT

DECLARE @VLRFAT1  AS FLOAT
DECLARE @VLRFAT2  AS FLOAT
DECLARE @VLRFAT3  AS FLOAT
DECLARE @VLRFAT4  AS FLOAT
DECLARE @VLRFAT5  AS FLOAT
DECLARE @VLRFAT6  AS FLOAT
DECLARE @VLRFAT7  AS FLOAT
DECLARE @VLRFAT8  AS FLOAT
DECLARE @VLRFAT9  AS FLOAT
DECLARE @VLRFAT10 AS FLOAT
DECLARE @VLRFAT11 AS FLOAT
DECLARE @VLRFAT12 AS FLOAT
DECLARE @VLRTOTFAT AS FLOAT

SET @VLRTOTGERF1_1 = 0
SET @VLRTOTGERF1_2 = 0
SET @VLRTOTGERF1_3 = 0
SET @VLRTOTGERF1_4 = 0
SET @VLRTOTGERF1_5 = 0
SET @VLRTOTGERF1_6 = 0
SET @VLRTOTGERF1_7 = 0
SET @VLRTOTGERF1_8 = 0
SET @VLRTOTGERF1_9 = 0
SET @VLRTOTGERF1_10 = 0
SET @VLRTOTGERF1_11 = 0
SET @VLRTOTGERF1_12 = 0

SET @VLRTOTGERV1_1 = 0
SET @VLRTOTGERV1_2 = 0
SET @VLRTOTGERV1_3 = 0
SET @VLRTOTGERV1_4 = 0
SET @VLRTOTGERV1_5 = 0
SET @VLRTOTGERV1_6 = 0
SET @VLRTOTGERV1_7 = 0
SET @VLRTOTGERV1_8 = 0
SET @VLRTOTGERV1_9 = 0
SET @VLRTOTGERV1_10 = 0
SET @VLRTOTGERV1_11 = 0
SET @VLRTOTGERV1_12 = 0

DECLARE NIVEL0 CURSOR FOR
	SELECT CODCENCUS,DESCRCENCUS
	FROM Tsicus 
	where (GRAU = 3 AND (CODCENCUSPAI > 300000 AND SUBSTRING(DESCRCENCUS,1,1) = 'F' 
		AND ((DESCRCENCUS LIKE '%BRINDES%' AND @P_DIVISAO = 'B') 
		OR (DESCRCENCUS LIKE '%LOJAS%' AND @P_DIVISAO = 'L')  
		OR (DESCRCENCUS LIKE '%COMMERCE%' AND @P_DIVISAO = 'C') OR 
		(@P_DIVISAO = 'T') )) OR (CODCENCUS = 109000))
OPEN NIVEL0

FETCH NEXT FROM NIVEL0 INTO @CODCENCUS, @DESCRCENCUS

WHILE @@FETCH_STATUS = 0
BEGIN
		SET @VLRTOTF1_1 = SANKHYA.DashCustoFixMesRetornoBaixa(1,@P_ANO,@CODCENCUS)
		SET @VLRTOTF1_2 = SANKHYA.DashCustoFixMesRetornoBaixa(2,@P_ANO,@CODCENCUS)
		SET @VLRTOTF1_3 = SANKHYA.DashCustoFixMesRetornoBaixa(3,@P_ANO,@CODCENCUS)
		SET @VLRTOTF1_4 = SANKHYA.DashCustoFixMesRetornoBaixa(4,@P_ANO,@CODCENCUS)
		SET @VLRTOTF1_5 = SANKHYA.DashCustoFixMesRetornoBaixa(5,@P_ANO,@CODCENCUS)
		SET @VLRTOTF1_6 = SANKHYA.DashCustoFixMesRetornoBaixa(6,@P_ANO,@CODCENCUS)
		SET @VLRTOTF1_7 = SANKHYA.DashCustoFixMesRetornoBaixa(7,@P_ANO,@CODCENCUS)
		SET @VLRTOTF1_8 = SANKHYA.DashCustoFixMesRetornoBaixa(8,@P_ANO,@CODCENCUS)
		SET @VLRTOTF1_9 = SANKHYA.DashCustoFixMesRetornoBaixa(9,@P_ANO,@CODCENCUS)
		SET @VLRTOTF1_10 = SANKHYA.DashCustoFixMesRetornoBaixa(10,@P_ANO,@CODCENCUS)
		SET @VLRTOTF1_11 = SANKHYA.DashCustoFixMesRetornoBaixa(11,@P_ANO,@CODCENCUS)
		SET @VLRTOTF1_12 = SANKHYA.DashCustoFixMesRetornoBaixa(12,@P_ANO,@CODCENCUS)	
		
		SET @VLRTOTGERALF1 = @VLRTOTF1_1 + @VLRTOTF1_2 + @VLRTOTF1_3 + @VLRTOTF1_4 + @VLRTOTF1_5 + 
		@VLRTOTF1_6 + @VLRTOTF1_7 + @VLRTOTF1_8 + @VLRTOTF1_9 + @VLRTOTF1_10 + @VLRTOTF1_11 + @VLRTOTF1_12

		INSERT @PRINCIPAL (CODCC, DESCRCC, NIVEL, JAN,FEV,MAR,ABR,MAI,JUN,JUL,AGO,SETE,OUTU,NOV,DEZ, TOT) 
		VALUES (@CODCENCUS,@DESCRCENCUS,1, @VLRTOTF1_1, @VLRTOTF1_2, @VLRTOTF1_3, @VLRTOTF1_4, @VLRTOTF1_5,
		@VLRTOTF1_6, @VLRTOTF1_7, @VLRTOTF1_8, @VLRTOTF1_9, @VLRTOTF1_10, @VLRTOTF1_11, @VLRTOTF1_12,@VLRTOTGERALF1) 

		SET @VLRTOTGERF1_1 =  @VLRTOTGERF1_1 + @VLRTOTF1_1
		SET @VLRTOTGERF1_2 =  @VLRTOTGERF1_2 + @VLRTOTF1_2
		SET @VLRTOTGERF1_3 =  @VLRTOTGERF1_3 + @VLRTOTF1_3
		SET @VLRTOTGERF1_4 =  @VLRTOTGERF1_4 + @VLRTOTF1_4
		SET @VLRTOTGERF1_5 =  @VLRTOTGERF1_5 + @VLRTOTF1_5
		SET @VLRTOTGERF1_6 =  @VLRTOTGERF1_6 + @VLRTOTF1_6
		SET @VLRTOTGERF1_7 =  @VLRTOTGERF1_7 + @VLRTOTF1_7
		SET @VLRTOTGERF1_8 =  @VLRTOTGERF1_8 + @VLRTOTF1_8
		SET @VLRTOTGERF1_9 =  @VLRTOTGERF1_9 + @VLRTOTF1_9
		SET @VLRTOTGERF1_10 =  @VLRTOTGERF1_10 + @VLRTOTF1_10
		SET @VLRTOTGERF1_11 =  @VLRTOTGERF1_11 + @VLRTOTF1_11
		SET @VLRTOTGERF1_12 =  @VLRTOTGERF1_12 + @VLRTOTF1_12

   FETCH NEXT FROM NIVEL0 INTO @CODCENCUS, @DESCRCENCUS
END
CLOSE NIVEL0
DEALLOCATE NIVEL0
	
	SET @VLRTOTGERGERALF1 = @VLRTOTGERF1_1+@VLRTOTGERF1_2+@VLRTOTGERF1_3+@VLRTOTGERF1_4+@VLRTOTGERF1_5+
	@VLRTOTGERF1_6+@VLRTOTGERF1_7+@VLRTOTGERF1_8+@VLRTOTGERF1_9+@VLRTOTGERF1_10+@VLRTOTGERF1_11+@VLRTOTGERF1_12

	INSERT @PRINCIPAL (CODCC,DESCRCC,NIVEL, JAN,FEV,MAR,ABR,MAI,JUN,JUL,AGO,SETE,OUTU,NOV,DEZ, TOT) 
	VALUES (0,'CUSTO FIXO TOTAL',1,@VLRTOTGERF1_1,@VLRTOTGERF1_2,@VLRTOTGERF1_3,@VLRTOTGERF1_4,
	@VLRTOTGERF1_5,@VLRTOTGERF1_6,@VLRTOTGERF1_7,@VLRTOTGERF1_8,@VLRTOTGERF1_9,@VLRTOTGERF1_10,
	@VLRTOTGERF1_11,@VLRTOTGERF1_12, @VLRTOTGERGERALF1)

	SET @VLRFAT1 = SANKHYA.DashFaturamentoRetornoTotal(1,@P_ANO,0,1,1)
	SET @VLRFAT2 = SANKHYA.DashFaturamentoRetornoTotal(2,@P_ANO,0,1,1)
	SET @VLRFAT3 = SANKHYA.DashFaturamentoRetornoTotal(3,@P_ANO,0,1,1)
	SET @VLRFAT4 = SANKHYA.DashFaturamentoRetornoTotal(4,@P_ANO,0,1,1)
	SET @VLRFAT5 = SANKHYA.DashFaturamentoRetornoTotal(5,@P_ANO,0,1,1)
	SET @VLRFAT6 = SANKHYA.DashFaturamentoRetornoTotal(6,@P_ANO,0,1,1)
	SET @VLRFAT7 = SANKHYA.DashFaturamentoRetornoTotal(7,@P_ANO,0,1,1)
	SET @VLRFAT8 = SANKHYA.DashFaturamentoRetornoTotal(8,@P_ANO,0,1,1)
	SET @VLRFAT9 = SANKHYA.DashFaturamentoRetornoTotal(9,@P_ANO,0,1,1)
	SET @VLRFAT10= SANKHYA.DashFaturamentoRetornoTotal(10,@P_ANO,0,1,1)
	SET @VLRFAT11= SANKHYA.DashFaturamentoRetornoTotal(11,@P_ANO,0,1,1)
	SET @VLRFAT12= SANKHYA.DashFaturamentoRetornoTotal(12,@P_ANO,0,1,1)

	SET @VLRTOTFAT = (@VLRFAT1 + @VLRFAT2 + @VLRFAT3 + @VLRFAT4 + @VLRFAT5 + @VLRFAT6 + @VLRFAT7
	+ @VLRFAT8 + @VLRFAT9 + @VLRFAT10 + @VLRFAT11 + @VLRFAT12)

	INSERT @PRINCIPAL (CODCC, DESCRCC, NIVEL,JAN, FEV, MAR, ABR, MAI, JUN, JUL, AGO, SETE, 
		OUTU, NOV, DEZ,TOT) VALUES (0,'FATURAMENTO GERAL',9,@VLRFAT1, @VLRFAT2, @VLRFAT3,
		@VLRFAT4, @VLRFAT5, @VLRFAT6, @VLRFAT7, @VLRFAT8, @VLRFAT9, @VLRFAT10, @VLRFAT11, @VLRFAT12,@VLRTOTFAT) 

--	INSERT @PRINCIPAL (CODCC, DESCRCC, NIVEL,JAN, FEV, MAR, ABR, MAI, JUN, JUL, AGO, SETE, 
--		OUTU, NOV, DEZ,TOT) VALUES (0,'DIFERENÃ‡A (R$)',9,@VLRFAT1-@VLRTOTGERF1_1, @VLRFAT2-@VLRTOTGERF1_2, 
--		@VLRFAT3-@VLRTOTGERF1_3,@VLRFAT4-@VLRTOTGERF1_4, @VLRFAT5-@VLRTOTGERF1_5, @VLRFAT6-@VLRTOTGERF1_6, 
--		@VLRFAT7-@VLRTOTGERF1_7, @VLRFAT8-@VLRTOTGERF1_8, @VLRFAT9-@VLRTOTGERF1_9, @VLRFAT10-@VLRTOTGERF1_10, 
--		@VLRFAT11-@VLRTOTGERF1_11, @VLRFAT12-@VLRTOTGERF1_12,@VLRTOTFAT-@VLRTOTGERGERALF1) 

	INSERT @PRINCIPAL (CODCC, DESCRCC, NIVEL,JAN, FEV, MAR, ABR, MAI, JUN, JUL, AGO, SETE, 
		OUTU, NOV, DEZ,TOT) VALUES (0,'CUSTO SOBRE FATURAMENTO (%)',9,
		CASE WHEN @VLRFAT1 = 0 THEN 0 ELSE (@VLRTOTGERF1_1/@VLRFAT1)*100 END, 
		CASE WHEN @VLRFAT2 = 0 THEN 0 ELSE (@VLRTOTGERF1_2/@VLRFAT2)*100 END, 
		CASE WHEN @VLRFAT3 = 0 THEN 0 ELSE (@VLRTOTGERF1_3/@VLRFAT3)*100 END, 
		CASE WHEN @VLRFAT4 = 0 THEN 0 ELSE (@VLRTOTGERF1_4/@VLRFAT4)*100 END, 
		CASE WHEN @VLRFAT5 = 0 THEN 0 ELSE (@VLRTOTGERF1_5/@VLRFAT5)*100 END, 
		CASE WHEN @VLRFAT6 = 0 THEN 0 ELSE (@VLRTOTGERF1_6/@VLRFAT6)*100 END, 
		CASE WHEN @VLRFAT7 = 0 THEN 0 ELSE (@VLRTOTGERF1_7/@VLRFAT7)*100 END, 
		CASE WHEN @VLRFAT8 = 0 THEN 0 ELSE (@VLRTOTGERF1_8/@VLRFAT8)*100 END, 
		CASE WHEN @VLRFAT9 = 0 THEN 0 ELSE (@VLRTOTGERF1_9/@VLRFAT9)*100 END, 
		CASE WHEN @VLRFAT10 = 0 THEN 0 ELSE (@VLRTOTGERF1_10/@VLRFAT10)*100 END, 
		CASE WHEN @VLRFAT11 = 0 THEN 0 ELSE (@VLRTOTGERF1_11/@VLRFAT11)*100 END, 
		CASE WHEN @VLRFAT12 = 0 THEN 0 ELSE (@VLRTOTGERF1_12/@VLRFAT12)*100 END,
		CASE WHEN @VLRTOTFAT = 0 THEN 0 ELSE (@VLRTOTGERGERALF1/@VLRTOTFAT)*100 END)

	INSERT @PRINCIPAL (CODCC, DESCRCC) values ('','')
	INSERT @PRINCIPAL (CODCC, DESCRCC) values ('','')

DECLARE NIVEL1 CURSOR FOR
	SELECT CODCENCUS,DESCRCENCUS
	FROM Tsicus 
	where (GRAU = 3 AND (CODCENCUSPAI > 300000 AND SUBSTRING(DESCRCENCUS,1,1) = 'V' 
		AND ((DESCRCENCUS LIKE '%BRINDES%' AND @P_DIVISAO = 'B') 
		OR (DESCRCENCUS LIKE '%LOJAS%' AND @P_DIVISAO = 'L')  
		OR (DESCRCENCUS LIKE '%COMMERCE%' AND @P_DIVISAO = 'C') OR 
		(@P_DIVISAO = 'T') )) OR (CODCENCUS = 1090000))
	ORDER BY TSICUS.CODCENCUS

OPEN NIVEL1

FETCH NEXT FROM NIVEL1 INTO @CODCENCUS, @DESCRCENCUS

WHILE @@FETCH_STATUS = 0
BEGIN
		SET @VLRTOTV1_1 = SANKHYA.DashCustoFixMesRetornoBaixa(1,@P_ANO,@CODCENCUS)
		SET @VLRTOTV1_2 = SANKHYA.DashCustoFixMesRetornoBaixa(2,@P_ANO,@CODCENCUS)
		SET @VLRTOTV1_3 = SANKHYA.DashCustoFixMesRetornoBaixa(3,@P_ANO,@CODCENCUS)
		SET @VLRTOTV1_4 = SANKHYA.DashCustoFixMesRetornoBaixa(4,@P_ANO,@CODCENCUS)
		SET @VLRTOTV1_5 = SANKHYA.DashCustoFixMesRetornoBaixa(5,@P_ANO,@CODCENCUS)
		SET @VLRTOTV1_6 = SANKHYA.DashCustoFixMesRetornoBaixa(6,@P_ANO,@CODCENCUS)
		SET @VLRTOTV1_7 = SANKHYA.DashCustoFixMesRetornoBaixa(7,@P_ANO,@CODCENCUS)
		SET @VLRTOTV1_8 = SANKHYA.DashCustoFixMesRetornoBaixa(8,@P_ANO,@CODCENCUS)
		SET @VLRTOTV1_9 = SANKHYA.DashCustoFixMesRetornoBaixa(9,@P_ANO,@CODCENCUS)
		SET @VLRTOTV1_10 = SANKHYA.DashCustoFixMesRetornoBaixa(10,@P_ANO,@CODCENCUS)
		SET @VLRTOTV1_11 = SANKHYA.DashCustoFixMesRetornoBaixa(11,@P_ANO,@CODCENCUS)
		SET @VLRTOTV1_12 = SANKHYA.DashCustoFixMesRetornoBaixa(12,@P_ANO,@CODCENCUS)	
		
		SET @VLRTOTGERALV1 = @VLRTOTV1_1 + @VLRTOTV1_2 + @VLRTOTV1_3 + @VLRTOTV1_4 + @VLRTOTV1_5 + 
		@VLRTOTV1_6 + @VLRTOTV1_7 + @VLRTOTV1_8 + @VLRTOTV1_9 + @VLRTOTV1_10 + @VLRTOTV1_11 + @VLRTOTV1_12

		INSERT @PRINCIPAL (CODCC, DESCRCC, NIVEL, JAN,FEV,MAR,ABR,MAI,JUN,JUL,AGO,SETE,OUTU,NOV,DEZ, TOT) 
		VALUES (@CODCENCUS,@DESCRCENCUS,1, @VLRTOTV1_1, @VLRTOTV1_2, @VLRTOTV1_3, @VLRTOTV1_4, @VLRTOTV1_5,
		@VLRTOTV1_6, @VLRTOTV1_7, @VLRTOTV1_8, @VLRTOTV1_9, @VLRTOTV1_10, @VLRTOTV1_11, @VLRTOTV1_12,@VLRTOTGERALV1) 

		SET @VLRTOTGERV1_1 =  @VLRTOTGERV1_1 + @VLRTOTV1_1
		SET @VLRTOTGERV1_2 =  @VLRTOTGERV1_2 + @VLRTOTV1_2
		SET @VLRTOTGERV1_3 =  @VLRTOTGERV1_3 + @VLRTOTV1_3
		SET @VLRTOTGERV1_4 =  @VLRTOTGERV1_4 + @VLRTOTV1_4
		SET @VLRTOTGERV1_5 =  @VLRTOTGERV1_5 + @VLRTOTV1_5
		SET @VLRTOTGERV1_6 =  @VLRTOTGERV1_6 + @VLRTOTV1_6
		SET @VLRTOTGERV1_7 =  @VLRTOTGERV1_7 + @VLRTOTV1_7
		SET @VLRTOTGERV1_8 =  @VLRTOTGERV1_8 + @VLRTOTV1_8
		SET @VLRTOTGERV1_9 =  @VLRTOTGERV1_9 + @VLRTOTV1_9
		SET @VLRTOTGERV1_10 =  @VLRTOTGERV1_10 + @VLRTOTV1_10
		SET @VLRTOTGERV1_11 =  @VLRTOTGERV1_11 + @VLRTOTV1_11
		SET @VLRTOTGERV1_12 =  @VLRTOTGERV1_12 + @VLRTOTV1_12

   FETCH NEXT FROM NIVEL1 INTO @CODCENCUS, @DESCRCENCUS
END
CLOSE NIVEL1
DEALLOCATE NIVEL1

	SET @VLRTOTGERGERALV1 = @VLRTOTGERV1_1+@VLRTOTGERV1_2+@VLRTOTGERV1_3+@VLRTOTGERV1_4+@VLRTOTGERV1_5+
	@VLRTOTGERV1_6+@VLRTOTGERV1_7+@VLRTOTGERV1_8+@VLRTOTGERV1_9+@VLRTOTGERV1_10+@VLRTOTGERV1_11+@VLRTOTGERV1_12

	INSERT @PRINCIPAL (CODCC,DESCRCC,NIVEL, JAN,FEV,MAR,ABR,MAI,JUN,JUL,AGO,SETE,OUTU,NOV,DEZ, TOT) 
	VALUES (0,'CUSTO VARIAVEL TOTAL',1,@VLRTOTGERV1_1,@VLRTOTGERV1_2,@VLRTOTGERV1_3,@VLRTOTGERV1_4,
	@VLRTOTGERV1_5,@VLRTOTGERV1_6,@VLRTOTGERV1_7,@VLRTOTGERV1_8,@VLRTOTGERV1_9,@VLRTOTGERV1_10,
	@VLRTOTGERV1_11,@VLRTOTGERV1_12, @VLRTOTGERGERALV1)
	
	INSERT @PRINCIPAL (CODCC, DESCRCC) values ('','')
	INSERT @PRINCIPAL (CODCC, DESCRCC) values ('','')

	RETURN
END


--SELECT * FROM DASHCUSTOFIXO(2023,'T')
--SELECT * FROM DASHCUSTOFIXO(2023, REPLACE('1,2,3',',','-'))
